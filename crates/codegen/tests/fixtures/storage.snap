---
source: crates/codegen/tests/yul.rs
expression: output
input_file: tests/fixtures/storage.fe
---
object "Coin" {
  code {
    function $init__StorPtr_Evm___207f35a85ac4062e() {
      let v0 := datasize("Coin_deployed")
      let v1 := dataoffset("Coin_deployed")
      codecopy(0, v1, v0)
      return(0, v0)
    }
    $init__StorPtr_Evm___207f35a85ac4062e()
  }

  object "Coin_deployed" {
    code {
      function $abi_encode($value, $ops) {
        let v0 := 0
        mstore(v0, $value)
        return(v0, 32)
      }
      function $balance_of_raw__StorPtr_CoinStore___ba1c0d0726e89ba2($user, $store) -> ret {
        let v0 := 0
        switch $user
          case 0 {
            let v1 := sload($store)
            v0 := v1
          }
          default {
            let v2 := sload(add($store, 1))
            v0 := v2
          }
        ret := v0
        leave
      }
      function $credit_alice__StorPtr_CoinStore__StorPtr_TotalSupply___c407f5b00af9ba78($amount, $store, $supply) -> ret {
        let v0 := sload($store)
        let v1 := $u256_add_add(v0, $amount)
        sstore($store, v1)
        let v2 := sload($supply)
        let v3 := $u256_add_add(v2, $amount)
        sstore($supply, v3)
        let v4 := sload($store)
        ret := v4
        leave
      }
      function $credit_bob__StorPtr_CoinStore__StorPtr_TotalSupply___c407f5b00af9ba78($amount, $store, $supply) -> ret {
        let v0 := sload(add($store, 1))
        let v1 := $u256_add_add(v0, $amount)
        sstore(add($store, 1), v1)
        let v2 := sload($supply)
        let v3 := $u256_add_add(v2, $amount)
        sstore($supply, v3)
        let v4 := sload(add($store, 1))
        ret := v4
        leave
      }
      function $runtime__StorPtr_Evm___207f35a85ac4062e() {
        let v0 := $stor_ptr__Evm_CoinStore__d1ec7298de486d2f(0, 0)
        let v1 := $stor_ptr__Evm_TotalSupply__b0f1a753085dcbd(0, 2)
        let v2 := v0
        let v3 := v1
        let v4 := calldataload(0)
        let v5 := shr(224, v4)
        switch v5
          case 2877082652 {
            let v6 := calldataload(4)
            let v7 := calldataload(36)
            let v8 := 0
            switch v6
              case 0 {
                let v9 := $credit_alice__StorPtr_CoinStore__StorPtr_TotalSupply___c407f5b00af9ba78(v7, v2, v3)
                v8 := v9
              }
              default {
                let v10 := $credit_bob__StorPtr_CoinStore__StorPtr_TotalSupply___c407f5b00af9ba78(v7, v2, v3)
                v8 := v10
              }
            let v11 := v8
            $abi_encode(v11, 0)
          }
          case 1818602213 {
            let v12 := calldataload(4)
            let v13 := $balance_of_raw__StorPtr_CoinStore___ba1c0d0726e89ba2(v12, v2)
            $abi_encode(v13, 0)
          }
          case 217554442 {
            let v14 := calldataload(4)
            let v15 := calldataload(36)
            let v16 := 0
            switch v14
              case 0 {
                let v17 := $transfer_from_alice__StorPtr_CoinStore___ba1c0d0726e89ba2(v15, v2)
                v16 := v17
              }
              default {
                let v18 := $transfer_from_bob__StorPtr_CoinStore___ba1c0d0726e89ba2(v15, v2)
                v16 := v18
              }
            let v19 := v16
            let v20 := $transfer_result_code(v19)
            $abi_encode(v20, 0)
          }
          case 960555502 {
            let v21 := $total_supply__StorPtr_TotalSupply___2e654c25952f42f9(v3)
            $abi_encode(v21, 0)
          }
          default {
            return(0, 0)
          }
      }
      function $stor_ptr__Evm_CoinStore__d1ec7298de486d2f($self, $slot) -> ret {
        let v0 := $storptr_t__effectref_from_raw__CoinStore__fc61705bf538fde2($slot)
        ret := v0
        leave
      }
      function $stor_ptr__Evm_TotalSupply__b0f1a753085dcbd($self, $slot) -> ret {
        let v0 := $storptr_t__effectref_from_raw__CoinStore__fc61705bf538fde2($slot)
        ret := v0
        leave
      }
      function $storptr_t__effectref_from_raw__CoinStore__fc61705bf538fde2($raw) -> ret {
        ret := $raw
        leave
      }
      function $total_supply__StorPtr_TotalSupply___2e654c25952f42f9($supply) -> ret {
        let v0 := sload($supply)
        ret := v0
        leave
      }
      function $transfer_from_alice__StorPtr_CoinStore___ba1c0d0726e89ba2($amount, $store) -> ret {
        let v0 := sload($store)
        let v1 := $u256_ord_lt(v0, $amount)
        let v2 := v1
        if v2 {
          let v3 := mload(0x40)
          if iszero(v3) {
            v3 := 0x80
          }
          mstore(0x40, add(v3, 32))
          mstore(v3, 1)
          ret := v3
          leave
        }
        if iszero(v2) {
          let v4 := sload($store)
          let v5 := $u256_sub_sub(v4, $amount)
          sstore($store, v5)
          let v6 := sload(add($store, 1))
          let v7 := $u256_add_add(v6, $amount)
          sstore(add($store, 1), v7)
          let v8 := mload(0x40)
          if iszero(v8) {
            v8 := 0x80
          }
          mstore(0x40, add(v8, 32))
          mstore(v8, 0)
          ret := v8
          leave
        }
      }
      function $transfer_from_bob__StorPtr_CoinStore___ba1c0d0726e89ba2($amount, $store) -> ret {
        let v0 := sload(add($store, 1))
        let v1 := $u256_ord_lt(v0, $amount)
        let v2 := v1
        if v2 {
          let v3 := mload(0x40)
          if iszero(v3) {
            v3 := 0x80
          }
          mstore(0x40, add(v3, 32))
          mstore(v3, 1)
          ret := v3
          leave
        }
        if iszero(v2) {
          let v4 := sload(add($store, 1))
          let v5 := $u256_sub_sub(v4, $amount)
          sstore(add($store, 1), v5)
          let v6 := sload($store)
          let v7 := $u256_add_add(v6, $amount)
          sstore($store, v7)
          let v8 := mload(0x40)
          if iszero(v8) {
            v8 := 0x80
          }
          mstore(0x40, add(v8, 32))
          mstore(v8, 0)
          ret := v8
          leave
        }
      }
      function $transfer_result_code($res) -> ret {
        let v0 := 0
        let v1 := mload($res)
        switch v1
          case 0 {
            v0 := 0
          }
          case 1 {
            v0 := 1
          }
          default {
          }
        ret := v0
        leave
      }
      function $u256_add_add($self, $other) -> ret {
        let v0 := add($self, $other)
        let v1 := lt(v0, $self)
        let v2 := v1
        if v2 {
          revert(0, 0)
        }
        ret := v0
        leave
      }
      function $u256_ord_lt($self, $other) -> ret {
        let v0 := lt($self, $other)
        ret := v0
        leave
      }
      function $u256_sub_sub($self, $other) -> ret {
        let v0 := gt($other, $self)
        let v1 := v0
        if v1 {
          revert(0, 0)
        }
        let v2 := sub($self, $other)
        ret := v2
        leave
      }
      $runtime__StorPtr_Evm___207f35a85ac4062e()
      return(0, 0)
    }
  }
}
